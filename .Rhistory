library(dplyr)
library(sp)
library(rgdal)
library(raster)
# library(leafletR) # alternative method for visualization
library(leaflet)
library(htmlwidgets)
library(jsonlite)
library(RColorBrewer)
library(rgeos)
regionAll <- readOGR(dsn='/var/data/ohi/git-annex/Global/NCEAS-Regions_v2014/data/website_OHIplus_regions',
layer="allRegions")
plot(regionAll)
getwd()
regions <- read.csv('assets/maps/regions.csv')
regionAll <- regionAll[regionAll@data$Region %in% regions$Region, ]
colors <- data.frame(Status = c("conduct", "inform", "plan", "learn"),
color= c('#0257A5', '#0014A5', '#0083A3', '#00ADDD'))
regionAll@data <- regionAll@data %>%
left_join(regions, by="Region") %>%
left_join(colors, by="Status")
popup1 <- paste0('<b>', regionAll@data$Region, '</b>',
'<br/>', "status: ", regionAll@data$Status) # use this for new line: , "<br/>")
# myPalette <- colorRampPalette(brewer.pal(11, "Spectral"))
# myPalette <- colorRampPalette(c("#9E0142", "#D53E4F", "#F46D43", "#FDAE61", "#3288BD", "#5E4FA2"))
# myPalette <- topo.colors(nrow(regionAll@data), alpha=NULL)
m <- leaflet(width="100%", height="600px") %>%
setView(m, -30, 30, 3) %>%
addTiles(options=tileOptions(minZoom=3, noWrap=TRUE)) %>%
#addProviderTiles("OpenStreetMap.BlackAndWhite") %>%
#   addTiles(options = tileOptions(noWrap = TRUE)) %>%
#   fitBounds(-180, -70, 180, 80) %>%
addPolygons(data = regionAll,
#fillColor = myPalette(nrow(regionAll)),
fillColor = regionAll@data$color,
popup=popup1,
#stroke=FALSE,
color = "#A8A8A8",
weight = 1,
opacity = 0.5,
fillOpacity = 0.4)
m <- leaflet(width="100%", height="600px") %>%
setView(m, -30, 30, 3) %>%
addTiles(options=tileOptions(minZoom=3, noWrap=TRUE)) %>%
#addProviderTiles("OpenStreetMap.BlackAndWhite") %>%
#   addTiles(options = tileOptions(noWrap = TRUE)) %>%
#   fitBounds(-180, -70, 180, 80) %>%
addPolygons(data = regionAll,
#fillColor = myPalette(nrow(regionAll)),
fillColor = regionAll@data$color,
popup=popup1,
#stroke=FALSE,
color = "#A8A8A8",
weight = 1,
opacity = 0.5,
fillOpacity = 0.4)
leaflet(width="100%", height="600px") %>%
setView(m, -30, 30, 3) %>%
addTiles(options=tileOptions(minZoom=3, noWrap=TRUE)) %>%
#addProviderTiles("OpenStreetMap.BlackAndWhite") %>%
#   addTiles(options = tileOptions(noWrap = TRUE)) %>%
#   fitBounds(-180, -70, 180, 80) %>%
addPolygons(data = regionAll,
#fillColor = myPalette(nrow(regionAll)),
fillColor = regionAll@data$color,
popup=popup1,
#stroke=FALSE,
color = "#A8A8A8",
weight = 1,
opacity = 0.5,
fillOpacity = 0.4)
?setView
m <- leaflet(width="100%", height="600px") %>%
#      setView(-180, -30, 30, 180) %>%
addTiles(options=tileOptions(minZoom=3, noWrap=TRUE)) %>%
#addProviderTiles("OpenStreetMap.BlackAndWhite") %>%
#   addTiles(options = tileOptions(noWrap = TRUE)) %>%
#   fitBounds(-180, -70, 180, 80) %>%
addPolygons(data = regionAll,
#fillColor = myPalette(nrow(regionAll)),
fillColor = regionAll@data$color,
popup=popup1,
#stroke=FALSE,
color = "#A8A8A8",
weight = 1,
opacity = 0.5,
fillOpacity = 0.4)
m
m <- leaflet(width="100%", height="600px") %>%
#      setView(-180, -30, 30, 180) %>%
addTiles(options=tileOptions(noWrap=TRUE)) %>%
#      addTiles(options=tileOptions(minZoom=3, noWrap=TRUE)) %>%
#addProviderTiles("OpenStreetMap.BlackAndWhite") %>%
#   addTiles(options = tileOptions(noWrap = TRUE)) %>%
#   fitBounds(-180, -70, 180, 80) %>%
addPolygons(data = regionAll,
#fillColor = myPalette(nrow(regionAll)),
fillColor = regionAll@data$color,
popup=popup1,
#stroke=FALSE,
color = "#A8A8A8",
weight = 1,
opacity = 0.5,
fillOpacity = 0.4)
m
saveWidget(m, file="global2015/geojson/allRegions.html", selfcontained=FALSE)
saveWidget(m, file="allRegions.html", selfcontained=FALSE)
